<!doctype html>
<html lang="en" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel="stylesheet">
	<link rel="stylesheet" href="css/reset.css"> <!-- CSS reset -->
	<link rel="stylesheet" href="css/style.css"> <!-- Resource style -->

	<title>Ds. 20</title>

	<style>
		.cd-schedule .events li.events-group {
			width: calc(100% /1)
		}
		
		/* Star toggle button styles */
		.star-toggle {
			position: absolute;
			top: 5px;
			right: 8px;
			background: none;
			border: none;
			font-size: 16px;
			cursor: pointer;
			color: #ccc;
			transition: color 0.3s ease;
			z-index: 10;
			padding: 2px;
		}
		
		.star-toggle:hover {
			color: #ffd700;
		}
		
		.star-toggle.highlighted {
			color: #ffd700;
		}
		
		.single-event {
			position: relative;
		}
		
		.single-event.highlighted {
			border-left: 5px solid #ffd700 !important;
		}
		
		/* Show toggle styles */
		.show-toggle-container {
			text-align: center;
			margin: 20px 0;
			padding: 15px;
			background: #f5f5f5;
			border-radius: 8px;
		}
		
		.show-toggle-container h3 {
			margin: 0 0 15px 0;
			color: #333;
			font-size: 18px;
		}
		
		.toggle-switch {
			position: relative;
			display: inline-block;
			width: 180px;
			height: 40px;
			background: #ddd;
			border-radius: 20px;
			cursor: pointer;
			transition: background 0.3s ease;
		}
		
		.toggle-switch.favorites-mode {
			background: #ffd700;
		}
		
		.toggle-slider {
			position: absolute;
			top: 3px;
			left: 3px;
			width: 85px;
			height: 34px;
			background: white;
			border-radius: 17px;
			transition: transform 0.3s ease;
			display: flex;
			align-items: center;
			justify-content: center;
			font-weight: 600;
			font-size: 12px;
			color: #333;
		}
		
		.toggle-switch.favorites-mode .toggle-slider {
			transform: translateX(90px);
		}
		
		.toggle-labels {
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 0 15px;
			font-size: 12px;
			font-weight: 600;
			color: #666;
			pointer-events: none;
		}
		
		.single-event.hidden-by-filter {
			display: none !important;
		}
		
		.events-group.empty-after-filter {
			display: none !important;
		}
		
		.empty-favorites-message {
			display: none;
			text-align: center;
			padding: 40px 20px;
			color: #666;
			font-style: italic;
		}
		
		.empty-favorites-message.show {
			display: block;
		}
	</style>
</head>
<body>

<a href="./index.html"><button disabled>Ds. 20</button></a><a href="./index1.html"><button>Dm. 23</button></a><a href="./index2.html"><button>Dc. 24</button></a><a href="./index3.html"><button>Dv. 26</button></a><a href="./index4.html"><button>Ds. 27</button></a><a href="./index5.html"><button>Dg. 28</button></a>

<div class="show-toggle-container">
	<div class="toggle-switch" id="showToggle">
		<div class="toggle-slider"></div>
		<div class="toggle-labels">
			<span style="padding-left: 15px;">TOTS</span>
			<span>PREFERITS</span>
		</div>
	</div>
</div>

<div class="cd-schedule loading">
	<div class="timeline">
		<ul>
<li><span style="display: none">21:00</span></li>
<li><span style="display: none">21:30</span></li>
<li><span style="display: none">22:00</span></li>
<li><span style="display: none">22:30</span></li>
<li><span style="display: none">23:00</span></li>
<li><span style="display: none">23:30</span></li>
<li><span style="display: none">00:00</span></li>
<li><span style="display: none">00:00</span></li>
<li><span style="display: none">00:30</span></li>
<li><span style="display: none">00:30</span></li>
<li><span style="display: none">01:00</span></li>
<li><span style="display: none">01:00</span></li>
		</ul>
	</div> <!-- .timeline -->

	<div class="events">
		<ul>



			
<li class="events-group">
   <div class="top-info"><span>Platja del Bogatell</span></div>
   <ul><li class="single-event" data-start="21:05" data-end="22:00"  data-content="event-1" data-event="event-1" data-event-id="event-1">
        <button class="star-toggle" title="Toggle highlight">★</button>
        <a target="_blank" href="https://www.barcelona.cat/lamerce/ca/concert-de-doctor-prats">
            <em class="event-name" style="display: inline-block; font-size: 8px; color: #eee">Pop-rock</em>
            <em class="event-name">Doctor Prats</em>
        </a>
    </li></ul>
</li>





		</ul>
	</div>

	<div class="empty-favorites-message" id="emptyFavoritesMessage">
		<p>Encara no has seleccionat cap concert preferit.</p>
        <p>Fes clic al botó ★ en qualsevol concert per afegir-lo als teus preferits!</p>
	</div>

	<div class="event-modal">
		<header class="header">
			<div class="content">
				<span class="event-date"></span>
				<h3 class="event-name"></h3>
			</div>

			<div class="header-bg"></div>
		</header>

		<div class="body">
			<div class="event-info"></div>
			<div class="body-bg"></div>
		</div>

		<a href="#0" class="close">Close</a>
	</div>

	<div class="cover-layer"></div>
</div> <!-- .cd-schedule -->
<script src="js/modernizr.js"></script>
<script src="js/jquery-3.0.0.min.js"></script>
<script>
	if( !window.jQuery ) document.write('<script src="js/jquery-3.0.0.min.js"><\/script>');
</script>
<script src="js/main.js"></script> <!-- Resource jQuery -->

<script>
// Cookie utility functions
function setCookie(name, value, days) {
    const expires = new Date();
    expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
    document.cookie = name + '=' + value + ';expires=' + expires.toUTCString() + ';path=/';
}

function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for(let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
}

function getHighlightedEvents() {
    const highlighted = getCookie('highlightedEvents');
    return highlighted ? JSON.parse(highlighted) : [];
}

function saveHighlightedEvents(eventIds) {
    setCookie('highlightedEvents', JSON.stringify(eventIds), 365); // Save for 1 year
}

function getShowMode() {
    const mode = getCookie('showMode');
    return mode || 'all';
}

function saveShowMode(mode) {
    setCookie('showMode', mode, 365);
}

function updateColumnWidths() {
    const visibleStages = $('.events-group:not(.empty-after-filter)').length;
    const totalStages = $('.events-group').length;
    
    if (visibleStages > 0) {
        const newWidth = 100 / visibleStages;
        $('.events-group:not(.empty-after-filter)').css('width', newWidth + '%');
        $('.events-group.empty-after-filter').css('width', '0%');
    } else {
        // Reset to original width if no stages are visible
        const originalWidth = 100 / totalStages;
        $('.events-group').css('width', originalWidth + '%');
    }
}

function applyShowFilter() {
    const showMode = getShowMode();
    const highlightedEvents = getHighlightedEvents();
    const toggle = $('#showToggle');
    const slider = toggle.find('.toggle-slider');
    const emptyMessage = $('#emptyFavoritesMessage');
    
    if (showMode === 'favorites') {
        toggle.addClass('favorites-mode');
        
        // Hide all non-favorite events
        $('.single-event').each(function() {
            const eventId = $(this).attr('data-event-id');
            if (!highlightedEvents.includes(eventId)) {
                $(this).addClass('hidden-by-filter');
            } else {
                $(this).removeClass('hidden-by-filter');
            }
        });
        
        // Check if any favorites exist and are visible
        const visibleFavorites = $('.single-event.highlighted:not(.hidden-by-filter)').length;
        if (visibleFavorites === 0) {
            emptyMessage.addClass('show');
        } else {
            emptyMessage.removeClass('show');
        }
        
    } else {
        toggle.removeClass('favorites-mode');
        
        $('.single-event').removeClass('hidden-by-filter');
        emptyMessage.removeClass('show');
    }
    
    // Update stage group visibility
    $('.events-group').each(function() {
        const visibleEvents = $(this).find('.single-event:not(.hidden-by-filter)').length;
        if (visibleEvents === 0 && showMode === 'favorites') {
            $(this).addClass('empty-after-filter');
        } else {
            $(this).removeClass('empty-after-filter');
        }
    });
    
    // Update column widths after filtering
    updateColumnWidths();
}

// Initialize everything when page loads
$(document).ready(function() {
    const highlightedEvents = getHighlightedEvents();
    
    // Apply saved highlights
    highlightedEvents.forEach(function(eventId) {
        const eventElement = $('[data-event-id="' + eventId + '"]');
        eventElement.addClass('highlighted');
        eventElement.find('.star-toggle').addClass('highlighted');
    });
    
    // Apply saved show mode
    applyShowFilter();
    
    // Handle show toggle clicks
    $('#showToggle').on('click', function() {
        const currentMode = getShowMode();
        const newMode = currentMode === 'all' ? 'favorites' : 'all';
        saveShowMode(newMode);
        applyShowFilter();
    });
    
    // Handle star toggle clicks
    $(document).on('click', '.star-toggle', function(e) {
        e.preventDefault();
        e.stopPropagation();
        
        const button = $(this);
        const eventElement = button.closest('.single-event');
        const eventId = eventElement.attr('data-event-id');
        let highlightedEvents = getHighlightedEvents();
        
        if (button.hasClass('highlighted')) {
            // Remove highlight
            button.removeClass('highlighted');
            eventElement.removeClass('highlighted');
            highlightedEvents = highlightedEvents.filter(id => id !== eventId);
        } else {
            // Add highlight
            button.addClass('highlighted');
            eventElement.addClass('highlighted');
            if (!highlightedEvents.includes(eventId)) {
                highlightedEvents.push(eventId);
            }
        }
        
        saveHighlightedEvents(highlightedEvents);
        
        // Reapply filter in case we're in favorites mode
        applyShowFilter();
    });
});
</script>
</body>
</html>
